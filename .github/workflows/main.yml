name: Cloud Ubuntu Desktop with LocalXpose

on: [workflow_dispatch]

jobs:
  desktop:
    runs-on: ubuntu-latest

    steps:
      - name: ‚¨áÔ∏è Pull Docker VNC image
        run: |
          docker pull accetto/ubuntu-vnc-xfce-g3

      - name: üü¢ Run Ubuntu XFCE noVNC container
        run: |
          docker run -d \
            -p 6080:6080 \
            --name ubuntu-gui \
            accetto/ubuntu-vnc-xfce-g3

      - name: ‚¨áÔ∏è Install unzip and wget
        run: sudo apt-get update && sudo apt-get install -y unzip wget

      - name: ‚¨áÔ∏è Download and setup LocalXpose
        run: |
          wget -O lx.zip https://github.com/localxpose/localxpose/releases/latest/download/localxpose-linux-amd64.zip
          unzip lx.zip -d lx_folder
          mv lx_folder/localxpose lx
          chmod +x lx

      - name: üåê Start LocalXpose tunnel to expose noVNC
        run: |
          ./lx tunnel http --to 127.0.0.1:6080 --token DgN6KiykIQ1cb7XvcoaYz2AXX68yIwvUndjYfchQ

