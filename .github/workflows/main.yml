name: Ubuntu VNC XFCE Desktop

on: workflow_dispatch

jobs:
  ubuntu-vnc:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup Docker
      uses: docker/setup-buildx-action@v3

    - name: Pull Docker Image
      run: docker pull accetto/ubuntu-vnc-xfce-g3

    - name: Run Ubuntu VNC Desktop with Kdenlive
      run: |
        docker run -d \
          --name ubuntu-vnc \
          -p 5901:5901 -p 6080:6080 \
          -e VNC_PW='hacktheplanet' \
          --shm-size=2g \
          accetto/ubuntu-vnc-xfce-g3

    - name: Install LocalXpose
      run: |
        curl -s https://api.localxpose.io/api/cli/install/linux -o lx
        chmod +x lx

    - name: Start LocalXpose Tunnel (noVNC)
      run: |
        ./lx tunnel http --port 6080 --subdomain yourcustomname
