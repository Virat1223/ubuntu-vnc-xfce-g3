name: 🖥️ Ubuntu Desktop via LocalXpose

on:
  workflow_dispatch:

jobs:
  run-desktop:
    runs-on: ubuntu-latest
    steps:
      - name: 🚀 Start Ubuntu VNC Desktop (XFCE)
        run: |
          docker run -d \
            --name ubuntu-desktop \
            -p 6080:6080 \
            accetto/ubuntu-vnc-xfce-g3

      - name: 💤 Wait for desktop to boot
        run: sleep 15

      - name: ⬇️ Download and setup LocalXpose
        run: |
          wget -O lx https://github.com/localxpose/localxpose/releases/latest/download/localxpose-linux-amd64
          chmod +x lx

      - name: 🌐 Start LocalXpose Tunnel
        run: |
          ./lx tunnel http --to 127.0.0.1:6080 --token DgN6KiykIQ1cb7XvcoaYz2AXX68yIwvUndjYfchQ
